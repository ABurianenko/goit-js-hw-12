{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["`use strict`\n\nimport axios from 'axios';\n\n\n\nimport { page, perPage } from '../main';\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"46816604-07077c66f94f9cd22bbea8735\"\n\nexport async function fetchData (nameSearch=\"\") {\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: nameSearch,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page,\n        per_page: perPage\n    })\n    \n    const { data } = await axios(`${BASE_URL}?${params}`);\n    \n    return data;\n\n    // return fetch(`${BASE_URL}?${params}`)\n    //     .then(response => {\n    //         if (!response.ok) {\n    //             throw new Error(response.statusText)\n    //         }\n\n    //         return response.json();\n    //     })\n}\n\n\n","`use strict`\n\n\n\nexport function createMarkup(arr) {  \n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class= \"gallery-item\" >\n            <a class=\"gallery-item-link\" href=\"${largeImageURL}\">\n                <img\n                class=\"item-img\"\n                src=\"${webformatURL}\" \n                data-source=\"${largeImageURL}\" \n                alt=\"${tags}\" />\n            </a>\n            <ul class=\"item-stat-list\">\n                <li class=\"item-stat\">\n                    <h2 class=\"item-stat-name\">Likes</h2>\n                    <p class=\"item-stat-amount\">${likes}</p>\n                </li>\n                <li class=\"item-stat\">\n                    <h2 class=\"item-stat-name\">Views</h2>\n                    <p class=\"item-stat-amount\">${views}</p>\n                </li>\n                <li class=\"item-stat\">\n                    <h2 class=\"item-stat-name\">Comments</h2>\n                    <p class=\"item-stat-amount\">${comments}</p>        \n                </li>\n                <li class=\"item-stat\">\n                    <h2 class=\"item-stat-name\">Downloads</h2>\n                    <p class=\"item-stat-amount\">${downloads}</p>\n                </li>\n            </ul>\n        </li>\n    `).join(\"\");\n\n    \n\n}\n\n\n","`use strict`\n\n// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".form-search\");\nconst list = document.querySelector('.gallery-markup');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.js-load-more')\n// console.log(loadMore);\n\nimport { fetchData } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\nform.addEventListener(\"submit\", handleSearch);\n\nlet page = 1;\nlet perPage = 15;\nlet nameSearch = '';\n\nexport { page, perPage, nameSearch };\n    \nconst instanse = new SimpleLightbox('.gallery-markup a', {\n  captionData: 'alt',\n  captionDelay: 250,\n});\n\nexport function handleSearch(event) {\n    event.preventDefault();\n\n    page = 1;\n    \n    const list = document.querySelector('.gallery-markup');\n    nameSearch = event.currentTarget.elements.title.value.toLowerCase().trim();\n    // console.log(nameSearch);\n\n    if (nameSearch===\"\") {\n       return\n    }\n    \n    resetMarkup();\n    showLoader();\n    \n\n    fetchData(nameSearch)\n        .then((data) => {\n            if (data.hits.length === 0) {\n                iziToast.error({\n                    position: 'center',\n                    message: `Sorry, there are no images matching your search query. Please try again!`,\n                });\n                hideLoader();\n                return;\n            }\n            // console.log(\"then\", data);\n            list.innerHTML = createMarkup(data.hits);\n\n            if (data.hits.length !== 0 && page * perPage < data.totalHits) {\n                loadMore.classList.replace(\"load-more-hidden\", \"load-more\")\n            };\n            \n            const images = list.querySelectorAll(\"img\");\n            const promises = Array.from(images).map(img => {\n                return new Promise((resolve, reject) => {\n                    img.onload = resolve;\n                    img.onerror = reject;\n                });\n            });\n\n            return Promise.all(promises).then(() => {\n                instanse.refresh('show.simplelightbox'); \n                hideLoader(); \n            });\n\n\n        })\n        .catch(error => {\n        console.log(\"catch\", error);\n        })\n        .finally(() => {\n            hideLoader();\n            form.reset();\n        })\n}\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\n\n\nasync function onLoadMore() {\n    page += 1;\n\n    try {\n        const data = await fetchData(nameSearch, page, perPage);\n        list.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n        instanse.refresh('show.simplelightbox'); \n\n        const cardSize = list.lastElementChild.getBoundingClientRect();\n        window.scrollBy({\n        top: cardSize.top + cardSize.height * 1.5,\n        behavior: 'smooth',\n        });\n\n        if (page * perPage >= data.totalHits) {\n            loadMore.classList.replace(\"load-more\", \"load-more-hidden\");\n            iziToast.show({\n            class: 'toast',\n            position: 'topRight',\n            message: `We're sorry, but you've reached the end of search results.`,\n        })\n        };\n        \n        \n        \n    } catch (error) {\n        console.log(error.message);\n        iziToast.error({\n        title: 'Error',\n        message: 'Failed to fetch images. Please try again later.',\n        timeout: 2500,\n        closeOnClick: true,\n        });\n    }\n}\n\nloadMore.addEventListener(\"click\", onLoadMore);\n\nfunction resetMarkup() {\n  list.innerHTML = '';\n}\n\nconst scrollToTopBtn = document.querySelector(\".scroll-to-top\");\n\nwindow.addEventListener(\"scroll\", () => {\n    if (window.scrollY > 300) {\n        scrollToTopBtn.classList.remove(\"hidden\");\n    } else {\n        scrollToTopBtn.classList.add(\"hidden\");\n    }\n});\n\nscrollToTopBtn.addEventListener(\"click\", () => {\n    window.scrollTo({\n        top: 0,\n        behavior: \"smooth\"\n    });\n});\n\n\n"],"names":["BASE_URL","API_KEY","fetchData","nameSearch","params","page","perPage","data","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","list","loader","loadMore","handleSearch","instanse","SimpleLightbox","event","resetMarkup","showLoader","iziToast","hideLoader","images","promises","img","resolve","reject","error","onLoadMore","cardSize","scrollToTopBtn"],"mappings":"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"}